{% extends "base.html" %}

{% block title %}All Users{% endblock %}

{% block extra_head %}
<!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>All Users</h2>
    <a href="{% url 'add_user' %}" class="btn btn-primary">+ Add User</a>
  </div>

  <table id="users-table" class="table table-striped table-bordered">
    <thead class="table-light">
      <tr>
        <th>Username</th>
        <th>Email</th>
        <th>First Name</th>
        <th>Last Name</th>
         <th>Group</th>
        <th>Is Admin</th>
        <th>Is Active</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr>
        <td>{{ user.username }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.first_name }}</td>
        <td>{{ user.last_name }}</td>
        <td>  {% with user.groups.all|first as group %}
    {{ group.name|default:"-" }}
  {% endwith %}</td>
<td>{% if user.is_staff %}Yes{% else %}No{% endif %}</td>
<td>{% if user.is_active %}Yes{% else %}No{% endif %}</td>
        <td>
          <a href="{% url 'edit_user' user.id %}" class="btn btn-sm btn-warning">Edit</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="7">No users found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

{% block scripts %}
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<!-- DataTables -->
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<script>
  $(document).ready(function () {
    $('#users-table').DataTable({
      pageLength: 10,
      lengthChange: true,
      searching: true,
      ordering: true,
      language: {
        search: "Search Users:"
      }
    });
  });
</script>
{% endblock %}
